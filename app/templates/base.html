<!DOCTYPE html>
<html lang="zxx">
    <head>
        <meta charset="UTF-8">
        <meta name="description" content="Sona Template">
        <meta name="keywords" content="Sona, unica, creative, html">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>SpartanSleep</title>

        <!-- Google Font -->
        <link href="https://fonts.googleapis.com/css?family=Lora:400,700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Cabin:400,500,600,700&display=swap" rel="stylesheet">

        <!-- Css Styles -->
        <link rel="stylesheet" href="{{ url_for('static',filename='css/bootstrap.min.css') }}" type="text/css">
        <link rel="stylesheet" href="{{ url_for('static',filename='css/font-awesome.min.css') }}" type="text/css">
        <link rel="stylesheet" href="{{ url_for('static',filename='css/elegant-icons.css') }}" type="text/css">
        <link rel="stylesheet" href="{{ url_for('static',filename='css/flaticon.css') }}" type="text/css">
        <link rel="stylesheet" href="{{ url_for('static',filename='css/owl.carousel.min.css') }}" type="text/css">
        <link rel="stylesheet" href="{{ url_for('static',filename='css/nice-select.css') }}" type="text/css">
        <link rel="stylesheet" href="{{ url_for('static',filename='css/jquery-ui.min.css') }}" type="text/css">
        <link rel="stylesheet" href="{{ url_for('static',filename='css/magnific-popup.css') }}" type="text/css">
        <link rel="stylesheet" href="{{ url_for('static',filename='css/slicknav.min.css') }}" type="text/css">
        <link rel="stylesheet" href="{{ url_for('static',filename='css/style.css') }}" type="text/css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        
        {% block head %}
        {% endblock %}
    </head>
    <style>
        .ui-menu-item {
            list-style: none; /* Remove default list-style */
            padding: 10px; /* Add padding for spacing */
            background-color: #f5f5f5; /* Background color */
            border-bottom: 1px solid #ddd; /* Separator line */
            cursor: pointer; /* Pointer cursor for interactivity */
            transition: background-color 0.3s ease; /* Smooth hover effect */
        }
        
        /* Hover effect for menu items */
        .ui-menu-item:hover {
            background-color: #e0e0e0; /* Background color on hover */
        }
    </style>
    <body>
        <!-- Page Preloder -->
        <div id="preloder">
            <div class="loader"></div>
        </div>

        <!-- Offcanvas Menu Section Begin -->
        <div class="offcanvas-menu-overlay"></div>
        <div class="canvas-open">
            <i class="icon_menu"></i>
        </div>
        <div class="offcanvas-menu-wrapper">
            <div class="canvas-close">
                <i class="icon_close"></i>
            </div>
            <div class="search-icon  search-switch">
                <i class="icon_search"></i>
            </div>
            <!-- <div class="header-configure-area">
                <div class="language-option">
                    <span>Account <i class="fa fa-angle-down"></i></span>
                    <div class="flag-dropdown">
                        <ul>
                            <li><a href="/login">Login</a></li>
                            <li><a href="#">Sign Up</a></li>
                        </ul>
                    </div>
                </div>
                <a href="#" class="bk-btn">Booking Now</a>
            </div> -->
            <nav class="mainmenu mobile-menu">
                <ul>
                    <li class="active"><a href="{{url_for('homePage')}}">Home</a></li>
                    <li><a href="./rooms.html">Rooms</a></li>
                    <li><a href="{{ url_for('aboutUs') }}">About Us</a></li>
                    <li><a href="./pages.html">Pages</a>
                        <ul class="dropdown">
                            <li><a href="./room-details.html">Room Details</a></li>
                            <li><a href="#">Deluxe Room</a></li>
                            <li><a href="#">Family Room</a></li>
                            <li><a href="#">Premium Room</a></li>
                        </ul>
                    </li>
                    <li><a href="./blog.html">News</a></li>
                    <li><a href="{{url_for('login')}}">Account</a></li>
                        <ul class="dropdown">
                            <li><a href="{{url_for('login')}}">Login</a></li>
                            <li><a href="#">Sign Up</a></li>
                        </ul>
                    </li>
                </ul>
            </nav>
            <div id="mobile-menu-wrap"></div>
        </div>
        <!-- Offcanvas Menu Section End -->

        <!-- Header Section Begin -->
        <header class="header-section">
            <!-- <div class="top-nav">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-6">
                        </div>
                        <div class="col-lg-6">
                            <div class="tn-right">
                                <div class="top-social">
                                <a href="#" class="bk-btn">Booking Now</a>
                                <div class="language-option">
                                    <span>Account <i class="fa fa-angle-down"></i></span>
                                    <div class="flag-dropdown">
                                        <ul>
                                            <li><a href="/login">Login</a></li>
                                            <li><a href="/signup">Sign Up</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div> -->
            <div class="menu-item">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-2">
                            <div class="logo">
                                <a href="{{url_for('homePage')}}">
                                    <img src="{{ url_for('static',filename='img/logo.png') }}" alt="">
                                </a>
                            </div>
                        </div>
                        <div class="col-lg-10">
                            <div class="nav-menu">
                                <nav class="mainmenu">
                                    <ul>
                                        <li class="active"><a href="{{url_for('homePage')}}">Home</a></li>
                                        <li><a href="./rooms.html">Rooms</a></li>
                                        <li><a href="{{url_for('aboutUs')}}">About Us</a></li>
                                        <li><a href="./pages.html">Pages</a>
                                            <ul class="dropdown">
                                                <li><a href="./room-details.html">Room Details</a></li>
                                                <li><a href="./blog-details.html">Blog Details</a></li>
                                                <li><a href="#">Family Room</a></li>
                                                <li><a href="#">Premium Room</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="./blog.html">News</a></li>
                                        {% if not current_user.is_authenticated %}
                                        <li><a href="{{url_for('login')}}">Account</a>
                                            <ul class="dropdown">
                                                <li><a href="{{url_for('login')}}">Login</a></li>
                                                <li><a href="{{url_for('signup')}}">Sign Up</a></li>
                                            </ul>
                                            
                                        </li>
                                        {% else %}
                                        <li><a href="{{url_for('homePage')}}">Welcome back {{current_user.firstName}} !</a>
                                            <ul class="dropdown">
                                                <li><a href="app/templates/reservations.html">Manage Reservations</a></li>
                                                <li><a href="{{url_for('logout')}}">Log out</a></li>
                                                <li><a href="{{url_for('delete', id=current_user.id)}}">Delete Account</a></li>
                                            </ul>
                                        </li>
                                        {% endif %}
                                    </ul>
                                </nav>                             
                                <div class="nav-right search-switch">
                                    <i class="icon_search"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <!-- Header End -->

        <!-- Search model Begin -->
        <div class="search-model">
            <div class="h-100 d-flex align-items-center justify-content-center">
                <div class="search-close-switch"><i class="icon_close"></i></div>
                <form class="search-model-form">
                    <input type="text" id="livebox" placeholder="Search for a City...">
                    <p id="datalist"></p>              
                </form>
            </div>
        </div>
        <script>
            $(document).ready(function () {
                $("#livebox").on("input", function (e) {
                    $("#datalist").empty();
                    const searchTerm = $(this).val();
                    
                    // Check if the search term is empty
                    if (!searchTerm) {
                        return;
                    }
        
                    $.ajax({
                        method: "POST",
                        url: "/search", // search
                        data: { text: searchTerm },
                        success: function (data) {
                            const searchResults = $("#datalist");
                            searchResults.empty();
                            
                            if (data.length > 0) {
                                data.forEach(function (result) {
                                    // Access the city and country properties and display them
                                // const menuItem = `<li class="ui-menu-item">${result.city}, ${result.country}</li>`;
                                const menuItem = `<li class="ui-menu-item"><a href="#" data-city-code="${result.cityCode}">${result.city}, ${result.country}</a></li>`;
                                searchResults.append(menuItem);
                                });

                                // Attach click event handlers to the menu items
                                const menuItems = searchResults.find(".ui-menu-item a");
                                menuItems.on("click", function (event) {
                                    event.preventDefault(); // Prevent the default link behavior
                                    const cityCode = $(this).data("city-code");
                                    redirectToPage(cityCode);
                                });
                            } else {
                                searchResults.append("<li>No results found</li>");
                            }
                        },
                        error: function () {
                            $("#datalist").html("<li>Error fetching data</li>");
                        }
                    });
                });
            });

    function redirectToPage(cityCode) {
    // Ensure that cityCode is not undefined
        if (cityCode !== undefined) {
            // You can use the cityCode here for further actions or redirection
            console.log("Clicked on cityCode: " + cityCode);

            // Example: Redirect to a new page with the cityCode as a query parameter
            window.location.href = `/hotels/${cityCode}`;
        } else {
            console.error("cityCode is undefined");
        }
    }
    </script>  
        {% block mycontent %}
        
        {% endblock %}

        <!-- Js Plugins -->
        <script src="{{ url_for('static',filename='js/jquery-3.3.1.min.js') }}"></script>
        <script src="{{ url_for('static',filename='js/bootstrap.min.js') }}"></script>
        <script src="{{ url_for('static',filename='js/jquery.magnific-popup.min.js') }}"></script>
        <script src="{{ url_for('static',filename='js/jquery.nice-select.min.js') }}"></script>
        <script src="{{ url_for('static',filename='js/jquery-ui.min.js') }}"></script>
        <script src="{{ url_for('static',filename='js/jquery.slicknav.js') }}"></script>
        <script src="{{ url_for('static',filename='js/owl.carousel.min.js') }}"></script>
        <script src="{{ url_for('static',filename='js/main.js') }}"></script>

    </body>
</html>