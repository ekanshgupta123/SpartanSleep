{% extends "base.html" %}
{% block head %}
    <meta charset="utf-8" />
    <!--<meta name=description content="This site was generated with Anima. www.animaapp.com"/>-->
    <!-- <link rel="shortcut icon" type=image/png href="https://animaproject.s3.amazonaws.com/home/favicon.png" /> -->
    <meta name="twitter:card" content="photo" />
    <link rel="stylesheet" type="text/css" href= "{{ url_for('static',filename='css/reservation.css') }}" />
    <link rel="stylesheet" type="text/css" href= "{{ url_for('static',filename='css/paynowpopup.css') }}" />
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/styleguide.css') }}" />
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/globals.css') }}" />
{% endblock %}
{% block mycontent %}
    <input type="hidden" id="anPageName" name="page" value="reservation" />
    <div class="reservation screen">
      <div class="pricing-2qMuan">
        <div class="x228-fJQx2o">${{ price }}</div>
        <div class="starts-from-fJQx2o">Starts from:</div>
      </div>
      <div class="hotel-name-2qMuan">
        <div class="san-jose-FEhXH1">{{hotel_data.address.countryCode}}, {{hotel_data.iataCode }}</div>
        <h1 class="title-FEhXH1">{{hotel_data.name}}</h1>
      </div>
      <div class="number-of-rooms-2qMuan">
        <div class="x2-bedroom-0r0Ge1 avenir-heavy-normal-black-18px"> {{guests}} Guests </div>
        <div class="group-3-t2pGgE">
            <div class="oval"></div>
            <div class="view-pjPGy5 view">
              <img
                class="shape-XZRxSO shape"
                src="{{ url_for('static',filename='img/reservation/reservation-shape-BA248263-3DAB-4556-B1B9-6B81AE9FCB4E@2x.png') }}"
                alt="Shape"
              />
            </div>
        </div>
      </div>
      <div class="number-of-bathrooms-2qMuan">
        <div class="x2-bathroom-t2pGgE avenir-heavy-normal-black-18px">{{rooms}} Rooms</div>
        <div class="group-3-t2pGgE">
          <div class="oval"></div>
          <div class="view-pjPGy5 view">
            <img
              class="shape-XZRxSO shape"
              src="{{ url_for('static',filename='img/reservation/reservation-shape-17DCF4AD-2DA2-4DC5-AFF8-B068EAF8A46F@2x.png') }}"
              alt="Shape"
            />
          </div>
        </div>
      </div>
      <div class="area-2qMuan">
        <div class="x1250-ft-6TipRZ avenir-heavy-normal-black-18px">1250 ftÂ²</div>
        <div class="group-4-6TipRZ">
          <div class="oval-copy-2-tW9DmP"></div>
          <div class="view-tW9DmP view">
            <img
              class="shape-HUShFb shape"
              src="{{ url_for('static',filename='img/reservation/reservation-shape-5C599CA9-BE2A-490B-843E-57B44E230ACF@2x.png') }}"
              alt="Shape"
            />
          </div>
        </div>
      </div>
      <div class="security-2qMuan">
        <div class="highly-secured-Gnn1vF avenir-heavy-normal-black-18px">Highly Secured</div>
        <div class="group-5-Gnn1vF">
          <div class="oval-copy-3-C5IOHv"></div>
          <div class="view-C5IOHv view">
            <img
              class="shape-u1G9uz shape"
              src="{{ url_for('static',filename='img/reservation/reservation-shape-6E7FFBE5-19F5-4D81-89A3-2ED36ADCFB61@2x.png') }}"
              alt="Shape"
            />
          </div>
        </div>
      </div>
      <div class="review-box-2qMuan">
        <div class="rectangle-Hipt0j"></div>
        <div class="reviews-Hipt0j">Reviews</div>
        <div class="group-10-Hipt0j">
          <div class="rectangle-prGmwI"></div>
          <div class="travis-prGmwI avenir-heavy-normal-black-18px">Travis</div>
          <p class="near-to-the-city-fr-prGmwI avenir-normal-delta-12px">
            Near to the city. Friendly staff, clean and calm bathrooms
          </p>
        </div>
        <div class="group-11-Hipt0j">
          <div class="rectangle-copy-hjoacg"></div>
          <div class="krishna-hjoacg avenir-heavy-normal-black-18px">Krishna</div>
          <p class="near-to-the-city-fr-copy-hjoacg avenir-normal-delta-12px">
            Near to the city. Friendly staff, clean and calm bathrooms
          </p>
        </div>
        <div class="group-12-Hipt0j">
          <div class="rectangle-copy-2-w9WsLt"></div>
          <div class="bianca-w9WsLt avenir-heavy-normal-black-18px">Bianca</div>
          <p class="near-to-the-city-fr-copy-2-w9WsLt avenir-normal-delta-12px">
            Near to the city. Friendly staff, clean and calm bathrooms
          </p>
        </div>
        <div class="group-13-Hipt0j">
          <div class="rectangle-copy-3-dEsAb9"></div>
          <div class="tim-dEsAb9 avenir-heavy-normal-black-18px">Tim</div>
          <p class="near-to-the-city-fr-copy-3-dEsAb9 avenir-normal-delta-12px">
            Near to the city. Friendly staff, clean and calm bathrooms
          </p>
        </div>
      </div>
      <div class="description-2qMuan description">
        <div class="description-FqgPgx description">Description</div>
        <p class="fast-secure-no-bo-FqgPgx">
          Fast &amp; Secure, No Booking or Cancellation Fee. Book Your Hotel Online and Save. Choose from Hundreds of
          Thousands of Properties in Over 200 Countries and Territories, Travel Guides, Exclusive Deals, Luxury Hotels.
          Check Photos. Budget Hotels. Earn Reward Nights. <br>
          <br>Check In: {{ checkIn }}
          <br>Check Out: {{ checkOut }}
          <br>Guests: {{ guests }}
          <br>Rooms: {{ rooms }}
        </p>
      </div>    
      <div class="hotel-header-image-2qMuan">
        <div class="rectangle-0rin7r"></div>
        <img class="url-0rin7r" 
        src="{{ url_for('static',filename='img/reservation/reservation-url-6F03EA39-B70A-4E6B-BE00-538C335CD152.jpg') }}" alt="url" />
      </div>
    </div>
    <button class="hotel-card-book-now-button" data-hotel-id="{{ hotel_data.hotelId }}" data-check-in="{{ checkIn }}" data-check-out="{{ checkOut }}" data-guests="{{ guests }}" data-rooms="{{ rooms }}" data-price="{{ price }}">Book Now</button>

    <div class="book-now-modal">
    <input type="hidden" id="hotel-card-book-now-button" name="page" value="paynowpopup" />
        <div class="container-center-horizontal">
            <div class="paynowpopup screen">
                <div class="pop-up-LLtJDx"></div>
                <div class="redeem-button-LLtJDx">
                    <div class="redeem-your-rewards-UzrHx9" id="payLaterBtn" data-hotel-id="" onclick="goToCheckout('pay-later')">Redeem Your Rewards</div>
                    <img
                            class="line-UzrHx9"
                            src="{{ url_for('static',filename='img/reservation/pay-now-popup-line-8D4B7E19-4333-47C5-B087-6ED52AE7014E@2x.png') }}"
                            alt="Line"
                    />
                </div>
                <div class="price-per-night-LLtJDx">Price per night</div>
                <div class="x397-LLtJDx avenir-heavy-normal-black-18px">${{ price }}</div>
                <p class="total-price-excl-ta-LLtJDx">Total price: ${{ price }} x {{ total_days }} days </p>
                {% set price = price | float %}
                {% set total_days = total_days | int %}
                <div class="x119000-LLtJDx avenir-heavy-normal-black-18px"> $ {{ price * total_days }}</div>
                <div class="pay-button-LLtJDx">
                    <div class="pay-now-loQjBM">Pay Now
                        <button id="payNowBtn" data-hotel-id="" onclick="goToCheckout('pay-now')">Pay Now</button>
                    </div>
                </div>
                <div class="modal-options">
                    <div class="oval-o0Zepj"></div>
                    
                    <div class="view-o0Zepj">
                        <img
                                class="path-olwGrp"
                                src="{{ url_for('static',filename='img/reservation/pay-now-popup-path-57BB45E3-7658-4014-8F93-EDB52FA4D088@2x.png') }}"
                                alt="Path"
                        />
                    </div>
                </div>
                <h1 class="title-LLtJDx">Payment methods</h1>
                <div class="payment-method-icons-LLtJDx">
                    <img
                            class="apple-pay-WEChdR"
                            src="{{ url_for('static',filename='img/reservation/pay-now-popup-applepay-F8532403-D85C-4B5A-BC13-8667853DCA14@2x.png') }}"
                            alt="ApplePay"
                    />
                    <img
                            class="google-pay-WEChdR"
                            src="{{ url_for('static',filename='img/reservation/pay-now-popup-googlepay-7B467B5E-9959-4222-BD57-6794E897726D@2x.png') }}"
                            alt="GooglePay"
                    />
                    <img
                            class="amex-WEChdR"
                            src="{{ url_for('static',filename='img/reservation/pay-now-popup-amex-5D0A3874-FF70-4BF2-94BA-4F2E8BDEAC6F@2x.png') }}"
                            alt="Amex"
                    />
                    <img
                            class="visa-WEChdR"
                            src="{{ url_for('static',filename='img/reservation/pay-now-popup-visa-970C1E5D-B168-4997-811A-1EE83ABAE6E1@2x.png') }}"
                            alt="Visa"
                    />
                    <img
                            class="mastercard-WEChdR"
                            src="{{ url_for('static',filename='img/reservation/pay-now-popup-mastercard-8E80ABD1-FDFA-4321-AE2F-99663C33CE06@2x.png') }}"
                            alt="Mastercard"
                    />
                    <img
                            class="pay-pal-WEChdR"
                            src="{{ url_for('static',filename='img/reservation/pay-now-popup-paypal-61E317E4-44E9-4E7A-B42A-7374AF04B6C6@2x.png') }}"
                            alt="PayPal"
                    />
                    <img
                            class="bitcoin-WEChdR"
                            src="{{ url_for('static',filename='img/reservation/pay-now-popup-bitcoin-CE237E73-5E94-4D93-A003-0AA5BBFE56A8@2x.png') }}"
                            alt="Bitcoin"
                    />

                </div>
                <p class="have-rewards-use-th-LLtJDx avenir-heavy-normal-black-18px" >Have Rewards? Use Them Now!</p>
            </div>
            </div>
    </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function()
        {
            var modal = document.querySelector('.book-now-modal');
            var closeModalBtn = document.querySelector('closeModalBtn');

        // Function to open the modal
        function openModal() {
            modal.style.display = 'block';
        }

        // Function to close the modal
        function closeModal() {
            modal.style.display = 'none';
        }

        // Attach click event to all 'Book Now' buttons
            var bookNowButtons = document.querySelectorAll('.hotel-card-book-now-button')
        // Assuming each hotel card has a data attribute 'data-hotel-id'
        bookNowButtons.forEach(function(button) {
        button.addEventListener('click', function() {
            var hotelId = this.dataset.hotelId;
            var checkIn = this.dataset.checkIn;
            var checkOut = this.dataset.checkOut;
            var guests = this.dataset.guests;
            var rooms = this.dataset.rooms;
            var price = this.dataset.price;

            var payNowBtn = document.getElementById('payNowBtn');
            payNowBtn.dataset.hotelId = hotelId;
            payNowBtn.dataset.checkIn = checkIn;
            payNowBtn.dataset.checkOut = checkOut;
            payNowBtn.dataset.guests = guests;
            payNowBtn.dataset.rooms = rooms;
            payNowBtn.dataset.price = price;
            // Debugging
            console.log('Line 179: checkIn:', checkIn);
            console.log('checkOut:', checkOut);
            console.log('guests:', guests);
            console.log('rooms:', rooms);
            console.log('hotelId:', hotelId);
            console.log('price:', price);

            var payLaterBtn = document.getElementById('payLaterBtn');
            payLaterBtn.dataset.hotelId = hotelId;
            payLaterBtn.dataset.checkIn = checkIn;
            payLaterBtn.dataset.checkOut = checkOut;
            payLaterBtn.dataset.guests = guests;
            payLaterBtn.dataset.rooms = rooms;
            payLaterBtn.dataset.price = price;

            // Debugging
            console.log('Line 193: checkIn:', checkIn);
            console.log('checkOut:', checkOut);
            console.log('guests:', guests);
            console.log('rooms:', rooms);
            console.log('hotelId:', hotelId);
            console.log('price:', price);
            openModal();
        });
    });

        // Close the modal when the close button is clicked
        closeModalBtn.addEventListener('click', closeModal);

        // Close the modal if the user clicks outside of it
        window.addEventListener('click', function(event) {
            if (event.target === modal) {
                closeModal();
            }
        });
    });

    function goToCheckout(checkoutType) {
        var hotelId = document.getElementById('payNowBtn').dataset.hotelId; // Both buttons have the same hotel ID
        var checkIn = document.getElementById('payNowBtn').dataset.checkIn;
        var checkOut = document.getElementById('payNowBtn').dataset.checkOut;
        var guests = document.getElementById('payNowBtn').dataset.guests;
        var rooms = document.getElementById('payNowBtn').dataset.rooms;
        var price = document.getElementById('payNowBtn').dataset.price;

        // Debugging
        console.log('Line 221: goToCheckout: checkIn:', checkIn);
        console.log('checkOut:', checkOut);
        console.log('guests:', guests);
        console.log('rooms:', rooms);
        console.log('hotelId:', hotelId);
        console.log('price:', price);

        if (hotelId) {
            var checkoutUrl = '/checkout/' + checkoutType + '/' + hotelId +
                '?checkIn=' + checkIn + '&checkOut=' + checkOut +
                '&guests=' + guests + '&rooms=' + rooms + '&price=' + price;
            window.location.href = checkoutUrl;
        } else {
            console.error('Hotel ID is not set');
        }
    }
    </script>
{% endblock %}